# Pigeon App
## Expected Functions

- Adding a person to the directory.
- Removing a person from the directory.
- Adding contact information to a person in the directory.
- Removing contact information from a person in the directory.
- Listing all contacts in the directory.
- Retrieving detailed information about a person, including their contact information.
- Generating a report of directory statistics based on the location of the contacts.
- Listing the reports generated by the system.
- Retrieving detailed information about a specific report generated by the system.
## Technical Design

- Contacts: 
The system should theoretically allow an unlimited number of person records. Each person should be able to have unlimited associated contact information.
- Required data structure fields:
    - UUID
    - First Name
    - Last Name
    - Firm
    - Contact Information:
    - Type: Phone Number, Email Address, Location
    - Content
- Reports:
Report requests will operate asynchronously. When a user requests a report, the system should handle it sequentially in the background without creating bottlenecks. Once the report is completed, the user should be able to observe the status as "completed" through the endpoint that lists reports.
- Required report content:
    - Location
    - Number of contacts registered in the directory at that location
    - Number of phone numbers registered in the directory at that location
- Required data structure fields:
    - UUID
    - Report Request Date
    - Report Status (InProgress, Completed)

## Technical Expectations

Technologies to Be Used
- .NET Core
- Git
- PostgreSQL or MongoDB
- Message Queue system (e.g., Kafka)

## Notes

- There would be necessity parameters for all models, however the system (which should be implemented) had solid requirements.
- Some features such as logging mechanism are not implemented.
- The Filter method in the services requires a custom model called IFilterParams as an argument. This part is .
- Kafka messages sent to the ReportService are designed in a fire-and-forget manner. If there are issues with these messages, the reports may be incorrect. However, this can be managed through a set of background services that will run overnight.
- Access to the ReportService via Kafka is limited to the ContactService. Information is sent to the ReportService whenever a contact is added, deleted, or updated.


# Input - Output

## Post Contact

```json
{
  "name": "name1",
  "surname": "surname1",
  "firm": {
    "name": "firm1",
    "location": {
      "name": "firm1street",
      "nviAddress": "123456",
      "address": "firm1address",
      "locationType": "Work"
    }
  },
  "contactInformations": [
    {
      "contactType": "Phone",
      "info": "+905559993636"
    },
    {
      "contactType": "Email",
      "info": "contac1@contacts.com"
    }
  ]
}
```

## Return ReactedResult Type Object

```json
{
  "success": true,
  "message": "",
  "model": {
    "id": "0194090d-a1e5-7f27-b534-1ee26916b532",
    "name": "name1",
    "surname": "surname1",
    "firmId": "0194090d-a254-7c7d-9b6d-4a036bc65a73",
    "firm": {
      "id": "0194090d-a254-7c7d-9b6d-4a036bc65a73",
      "name": "firm1",
      "locationId": "0194090d-a26a-7b8e-af07-135bc015af71",
      "location": {
        "id": "0194090d-a26a-7b8e-af07-135bc015af71",
        "name": "firm1street",
        "nviAddress": "123456",
        "address": "firm1address",
        "locationType": "Work"
      },
      "contacts": [
        null
      ]
    },
    "contactInformations": [
      {
        "id": "0194090d-a236-7e15-9d8e-96829f3fd5f5",
        "contactId": "0194090d-a1e5-7f27-b534-1ee26916b532",
        "contactType": "Phone",
        "info": "+905559993636",
        "contact": null
      },
      {
        "id": "0194090d-a251-7a76-ba43-fc28cf2065de",
        "contactId": "0194090d-a1e5-7f27-b534-1ee26916b532",
        "contactType": "Email",
        "info": "contac1@contacts.com",
        "contact": null
      }
    ]
  },
  "statusCode": "OK"
}
```



## Database State

```json
{
"Contact": [
	{
		"Id" : "0194090d-a1e5-7f27-b534-1ee26916b532",
		"Name" : "name1",
		"Surname" : "surname1",
		"FirmId" : "0194090d-a254-7c7d-9b6d-4a036bc65a73"
	}
]
}
```
```json
{
    "ContactInfo": [
    	{
    		"Id" : "0194090d-a236-7e15-9d8e-96829f3fd5f5",
    		"ContactId" : "0194090d-a1e5-7f27-b534-1ee26916b532",
    		"ContactType" : 0,
    		"Info" : "+905559993636"
    	},
    	{
    		"Id" : "0194090d-a251-7a76-ba43-fc28cf2065de",
    		"ContactId" : "0194090d-a1e5-7f27-b534-1ee26916b532",
    		"ContactType" : 1,
    		"Info" : "contac1@contacts.com"
    	}
    ]
}
```
```json
{
    "Firm": [
    	{
    		"Id" : "0194090d-a254-7c7d-9b6d-4a036bc65a73",
    		"Name" : "firm1",
    		"LocationId" : "0194090d-a26a-7b8e-af07-135bc015af71"
    	}
    ]
}
```
```json
{
    "Location": [
    	{
    		"Id" : "0194090d-a26a-7b8e-af07-135bc015af71",
    		"Name" : "firm1street",
    		"Address" : "firm1address",
    		"NVIAddress" : "123456",
    		"LocationType" : 0
    	}
    ]
}
```

## Kafka

After contact is added a kafka message from ContactService (in pigeon-crud-service) to ReportService (in pigeon-report-service). ReportService updates info such as below.

```json
{
"Info": [
	{
		"Id" : "01940ce6-4247-7b84-8561-0985758aad97",
		"Details" : "\"Count\"=>\"1\"",
		"InfoType" : 0
	}
]}

```